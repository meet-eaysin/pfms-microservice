# Expense Service CQRS Routes Configuration
# Add these routes to apps/api-gateway/configs/base/routes.yaml

# ============================================
# EXPENSE SERVICE ROUTES (CQRS)
# ============================================

# Expense Service Health Check
- name: expense-health
  service: expense-service
  paths:
    - /api/v2/expenses/health
  methods:
    - GET
  protocols:
    - http
    - https
  strip_path: false

# Expense Commands (Write Operations)
- name: expense-commands
  service: expense-service
  paths:
    - /api/v2/expenses
  methods:
    - POST
    - PUT
    - DELETE
  protocols:
    - http
    - https
  strip_path: false
  plugins:
    - name: cors
      config:
        origins: ['*']
        methods: ['POST', 'PUT', 'DELETE', 'OPTIONS']
        headers: ['Content-Type', 'Authorization', 'x-user-id']
    - name: rate-limiting
      config:
        minute: 30
        policy: local
    - name: request-size-limiting
      config:
        allowed_payload_size: 1

# Expense Queries (Read Operations)
- name: expense-queries
  service: expense-service
  paths:
    - /api/v2/expenses
  methods:
    - GET
  protocols:
    - http
    - https
  strip_path: false
  plugins:
    - name: cors
      config:
        origins: ['*']
        methods: ['GET', 'OPTIONS']
        headers: ['Content-Type', 'Authorization', 'x-user-id']
    - name: rate-limiting
      config:
        minute: 100
        policy: local

# Expense Statistics (Read-Heavy)
- name: expense-stats
  service: expense-service
  paths:
    - /api/v2/expenses/stats
  methods:
    - GET
  protocols:
    - http
    - https
  strip_path: false
  plugins:
    - name: cors
      config:
        origins: ['*']
        methods: ['GET', 'OPTIONS']
        headers: ['Content-Type', 'Authorization', 'x-user-id']
    - name: rate-limiting
      config:
        minute: 50
        policy: local
    - name: response-ratelimiting
      config:
        limits:
          minute: 50
